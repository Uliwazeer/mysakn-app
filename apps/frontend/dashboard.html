<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MySakn Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body class="dashboard-layout">

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-logo">
            <i class="material-icons-round brand-icon" style="color:var(--primary); font-size: 32px;">cottage</i>
            <div style="display: flex; flex-direction: column;">
                <span style="font-weight: 800; font-size: 20px; color: #1e293b; line-height: 1.2;">MySakn</span>
                <small style="font-size: 10px; color: #64748b; font-weight: 600;">Housing & Community</small>
            </div>
        </div>

        <!-- Universal Navigation -->
        <div class="universal-nav" style="margin: 20px 0; padding-bottom: 20px; border-bottom: 1px solid #f1f5f9;">
            <a href="index.html" class="nav-item" style="text-decoration: none;">
                <i class="material-icons-round">home</i> Home
            </a>
            <a href="javascript:void(0)" class="nav-item" style="text-decoration: none;" onclick="handleUnivZoneNav()">
                <i class="material-icons-round">explore</i> Exploration
            </a>
        </div>

        <div class="nav-item active" onclick="showSection('overview')">
            <i class="material-icons-round">grid_view</i> Overview
        </div>

        <!-- Role Based Navigation -->
        <div class="nav-item role-restricted" id="nav-listings" onclick="showSection('my-listings')">
            <i class="material-icons-round">apartment</i> My Properties
        </div>

        <div class="nav-item role-restricted" id="nav-crm" style="display:none;" onclick="showSection('broker-crm')">
            <i class="material-icons-round">groups</i> CRM Pipeline
        </div>

        <div class="nav-item" id="nav-bookings" onclick="showSection('bookings')">
            <i class="material-icons-round">event_available</i> My Bookings
        </div>

        <div class="nav-item" onclick="showSection('messages')">
            <i class="material-icons-round">forum</i> Messages
            <span class="badge"
                style="background: #ef4444; color:white; border-radius: 50%; padding: 2px 6px; font-size: 10px; margin-left: auto;">2</span>
        </div>

        <div class="nav-item" onclick="showSection('community')">
            <i class="material-icons-round">groups</i> Community
        </div>

        <div class="nav-item role-restricted" id="nav-management" style="display:none;"
            onclick="showSection('management')">
            <i class="material-icons-round">analytics</i> Management Hub
        </div>

        <div class="nav-item" onclick="showSection('history')">
            <i class="material-icons-round">receipt_long</i> History
        </div>

        <div class="nav-item" onclick="showSection('wallet')">
            <i class="material-icons-round">payments</i> Wallet
        </div>

        <div class="nav-item admin-only" id="nav-admin" style="display:none; color: #7c3aed;"
            onclick="showSection('admin')">
            <i class="material-icons-round">admin_panel_settings</i> Admin Panel
        </div>

        <div style="margin-top: auto; border-top: 1px solid #f1f5f9; padding-top: 20px;">
            <div class="nav-item" onclick="showSection('support')">
                <i class="material-icons-round">help_outline</i> Support Center
            </div>
            <div class="nav-item" onclick="window.location.href='profile.html'">
                <i class="material-icons-round">settings</i> Settings
            </div>
            <div class="nav-item logout" onclick="db.logout()" style="color: #ef4444;">
                <i class="material-icons-round">logout</i> Logout
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="dash-header">
            <div>
                <h1 id="page-title" style="font-size: 24px; font-weight: 800; color: #1e293b; margin: 0;">Overview</h1>
                <p style="font-size: 14px; color: #64748b; margin: 4px 0 0;" id="welcomeMsg">Welcome back, User</p>
            </div>

            <div style="display: flex; align-items: center;">
                <div class="notifications-bell">
                    <i class="material-icons-round">notifications</i>
                    <span class="notif-badge">3</span>
                </div>

                <div class="user-profile">
                    <div class="avatar" id="userAvatar"
                        style="width: 40px; height: 40px; background: #e2e8f0; border-radius: 12px; display: grid; place-items: center; cursor: pointer;"
                        onclick="window.location.href='profile.html'">
                        <!-- Dynamic -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Overview Panel -->
        <div id="overview" class="panel active">

            <!-- Completeness Tracker (Demo) -->
            <div class="completeness-box">
                <div class="completeness-header">
                    <div>
                        <h4 style="margin: 0; font-size: 16px;">Profile Completeness</h4>
                        <p style="margin: 5px 0 0; font-size: 13px; opacity: 0.8;">Complete your profile to earn the
                            Verified badge.</p>
                    </div>
                    <span style="font-weight: 800; font-size: 18px;">75%</span>
                </div>
                <div class="completeness-bar">
                    <div class="completeness-fill"></div>
                </div>
                <button class="btn btn-text" style="color: white; padding: 0; font-size: 13px;"
                    onclick="window.location.href='profile.html'">Finish Setup ‚Üí</button>
            </div>

            <!-- Messages Panel -->
            <div id="messages" class="panel">
                <div class="card" style="padding: 0; display: flex; height: 500px; overflow: hidden;">
                    <div style="width: 280px; border-right: 1px solid #f1f5f9; display: flex; flex-direction: column;">
                        <div style="padding: 20px; border-bottom: 1px solid #f1f5f9;">
                            <h3 style="margin: 0; font-size: 18px;">Conversations</h3>
                        </div>
                        <div class="chat-list" style="flex: 1; overflow-y: auto;">
                            <div class="chat-item active"
                                style="padding: 15px; border-bottom: 1px solid #f8fafc; display: flex; align-items: center; gap: 12px; cursor: pointer; background: #f0f9ff;">
                                <div
                                    style="width: 40px; height: 40px; background: #3b82f6; border-radius: 12px; display: grid; place-items: center; color: white;">
                                    A</div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 700; font-size: 14px;">Ahmed Landlord</div>
                                    <div
                                        style="font-size: 12px; color: #64748b; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                        Property viewing inquiry</div>
                                </div>
                                <span style="font-size: 10px; color: #94a3b8;">10:30 AM</span>
                            </div>
                            <div class="chat-item"
                                style="padding: 15px; border-bottom: 1px solid #f8fafc; display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                <div
                                    style="width: 40px; height: 40px; background: #10b981; border-radius: 12px; display: grid; place-items: center; color: white;">
                                    S</div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 700; font-size: 14px;">Sarah Student</div>
                                    <div
                                        style="font-size: 12px; color: #64748b; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                        When can I move in?</div>
                                </div>
                                <span style="font-size: 10px; color: #94a3b8;">Yesterday</span>
                            </div>
                        </div>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column;">
                        <div
                            style="padding: 15px 20px; border-bottom: 1px solid #f1f5f9; display: flex; align-items: center; justify-content: space-between;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="font-weight: 800; font-size: 15px;">Ahmed Landlord</div>
                                <span style="width: 8px; height: 8px; background: #10b981; border-radius: 50%;"></span>
                                <small style="color: #64748b; font-size: 11px;">Online</small>
                            </div>
                            <button class="btn btn-text" style="color: #64748b;"><i class="material-icons-round"
                                    style="font-size: 18px;">more_vert</i></button>
                        </div>
                        <div id="chat-window"
                            style="flex: 1; padding: 20px; overflow-y: auto; background: #fffcf9; display: flex; flex-direction: column; gap: 15px;">
                            <div
                                style="align-self: flex-start; background: #f1f5f9; padding: 10px 15px; border-radius: 12px 12px 12px 0; max-width: 70%; font-size: 14px; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                                Hello! I'm interested in your property in Nasr City. Is it available for a viewing this
                                weekend?
                            </div>
                            <div
                                style="align-self: flex-end; background: #059669; color: white; padding: 10px 15px; border-radius: 12px 12px 0 12px; max-width: 70%; font-size: 14px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);">
                                Welcome! Yes, it's available. Would Saturday at 2 PM work for you?
                            </div>
                        </div>
                        <div style="padding: 15px; border-top: 1px solid #f1f5f9; display: flex; gap: 10px;">
                            <button class="btn btn-text" style="color: #64748b; padding: 0 10px;"><i
                                    class="material-icons-round">attach_file</i></button>
                            <input type="text" id="chatInput" placeholder="Type a message..."
                                style="flex: 1; padding: 12px; border: 1px solid #e2e8f0; border-radius: 12px; outline: none; font-size: 14px;">
                            <button class="btn btn-primary" onclick="sendMessage()"
                                style="border-radius: 12px; height: 44px; padding: 0 20px;"><i
                                    class="material-icons-round" style="font-size: 18px;">send</i></button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- History Panel -->
            <div id="history" class="panel">
                <div class="card" style="padding: 30px;">
                    <h3 style="margin: 0 0 20px;">Booking History</h3>
                    <div class="history-table">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="text-align: left; border-bottom: 1px solid #f1f5f9;">
                                    <th style="padding: 12px;">Property</th>
                                    <th>Date</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid #f1f5f9;">
                                    <td style="padding: 12px;">Cozy Studio in Dokki</td>
                                    <td>Feb 01, 2026</td>
                                    <td>EGP 4,500</td>
                                    <td><span class="status-pill status-confirmed">Completed</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Admin Panel -->
            <div id="admin" class="panel">
                <div class="dash-grid">
                    <div class="card" style="padding: 25px;">
                        <h3>Admin Management</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                            <button class="btn btn-outline full-width" style="padding: 15px;"><i
                                    class="material-icons-round">people</i> Manage Users</button>
                            <button class="btn btn-outline full-width" style="padding: 15px;"><i
                                    class="material-icons-round">home</i> Manage Listings</button>
                            <button class="btn btn-outline full-width" style="padding: 15px;"><i
                                    class="material-icons-round">bar_chart</i> Reports</button>
                            <button class="btn btn-primary full-width" style="padding: 15px;"><i
                                    class="material-icons-round">verified_user</i> Pending Verifications</button>
                        </div>
                    </div>
                    <div class="card" style="padding: 25px;">
                        <h3>Platform Statistics</h3>
                        <p style="color: gray;">Real-time overview of MySakn platform.</p>
                        <div style="margin-top: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>Active Students</span>
                                <strong>1,240</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>Active Landlords</span>
                                <strong>340</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>Total Bookings (Monthly)</span>
                                <strong>5,600</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <a href="#" class="action-card" onclick="showSection('add-listing'); return false;">
                    <i class="material-icons-round">add_home</i>
                    <div class="action-info">
                        <h4>Post Listing</h4>
                        <p>Add new property</p>
                    </div>
                </a>
                <a href="university_zone.html" class="action-card">
                    <i class="material-icons-round">search</i>
                    <div class="action-info">
                        <h4>Find Home</h4>
                        <p>Explore zones</p>
                    </div>
                </a>
                <a href="profile.html" class="action-card">
                    <i class="material-icons-round">person_outline</i>
                    <div class="action-info">
                        <h4>Edit Profile</h4>
                        <p>Update settings</p>
                    </div>
                </a>
            </div>

            <div class="stat-grid" style="margin-bottom: 32px;">
                <div class="stat-card">
                    <div class="stat-label">Total Bookings</div>
                    <div class="stat-val" id="totalBookings">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Active Listings</div>
                    <div class="stat-val" id="activeListings">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Wallet Balance</div>
                    <div class="stat-val" id="walletBalance">EGP 0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Earnings (MTD)</div>
                    <div class="stat-val" id="commissionPaid">EGP 4,200</div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="margin: 0; font-size: 18px; font-weight: 800; color: #1e293b;">Recent Activity</h3>
                <button class="btn btn-text" style="font-size: 13px;">View All</button>
            </div>

            <table class="list-table">
                <thead>
                    <tr>
                        <th>Activity</th>
                        <th>Reference</th>
                        <th>Date</th>
                        <th>Status</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody id="activityTable">
                    <!-- JS Populated -->
                </tbody>
            </table>
        </div>

        <!-- Listings Panel (Host/Broker Only) -->
        <div id="my-listings" class="panel">
            <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <h3>My Properties</h3>
                <button class="btn btn-primary" onclick="showSection('add-listing')">+ Add New Property</button>
            </div>
            <div class="listings-grid" id="dashboardListings">
                <!-- JS Populated -->
            </div>
        </div>

        <!-- Broker CRM Panel -->
        <div id="broker-crm" class="panel">
            <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <h3>Client Relationships (CRM)</h3>
                <button class="btn btn-primary">Add Lead</button>
            </div>
            <p style="color:gray; margin-bottom:20px;">Manage students and owners in your pipeline.</p>

            <div class="crm-pipeline" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                <div class="pipeline-col"
                    style="background:#f8fafc; padding: 15px; border-radius:12px; border: 1px solid #e2e8f0;">
                    <div class="pipeline-title"
                        style="margin-bottom: 15px; font-weight: 800; color: #64748b; font-size: 13px; text-transform: uppercase;">
                        New Leads</div>
                    <div class="pipeline-card"
                        style="background:white; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);">
                        <strong style="color: #1e293b;">Ahmed Ali</strong><br>
                        <small style="color: #64748b;">Looking for Room in Nasr City</small>
                    </div>
                </div>
                <div class="pipeline-col"
                    style="background:#f8fafc; padding: 15px; border-radius:12px; border: 1px solid #e2e8f0;">
                    <div class="pipeline-title"
                        style="margin-bottom: 15px; font-weight: 800; color: #64748b; font-size: 13px; text-transform: uppercase;">
                        Viewing Scheduled</div>
                    <div class="pipeline-card"
                        style="background:white; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);">
                        <strong style="color: #1e293b;">Sarah M.</strong><br>
                        <small style="color: #64748b;">Kasr Al Ainy Studio ‚Ä¢ Tomorrow 2 PM</small>
                    </div>
                </div>
                <div class="pipeline-col"
                    style="background:#f8fafc; padding: 15px; border-radius:12px; border: 1px solid #e2e8f0;">
                    <div class="pipeline-title"
                        style="margin-bottom: 15px; font-weight: 800; color: #64748b; font-size: 13px; text-transform: uppercase;">
                        Closing Deal</div>
                    <div class="pipeline-card"
                        style="background:white; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);">
                        <strong style="color: #1e293b;">Dr. Hisham</strong><br>
                        <small style="color: #64748b;">Contract Signing Pending</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wallet Panel -->
        <div id="wallet" class="panel">
            <h3 style="font-weight: 800; color: #1e293b;">Financial Overview</h3>
            <div class="stat-card" style="margin-bottom: 24px;">
                <div
                    style="display:flex; justify-content:space-between; align-items: center; border-bottom:1px solid #f1f5f9; padding-bottom:20px; margin-bottom: 20px;">
                    <div>
                        <div class="stat-label">Current Balance</div>
                        <div style="font-size:36px; font-weight:900; color:#10b981;">EGP <span
                                id="walletTotal">12,500</span></div>
                    </div>
                    <button class="btn btn-primary">Withdraw Funds</button>
                </div>

                <div class="grid-2" style="margin-bottom: 25px;">
                    <div
                        style="background: rgba(5, 150, 105, 0.05); padding: 15px; border-radius: 12px; border: 1px solid rgba(5, 150, 105, 0.1);">
                        <div style="color: #059669; font-size: 12px; font-weight: 800; text-transform: uppercase;">Total
                            Paid (Deposits)</div>
                        <div style="font-size: 20px; font-weight: 800; margin-top: 5px;">EGP 2,400</div>
                    </div>
                    <div
                        style="background: rgba(239, 68, 68, 0.05); padding: 15px; border-radius: 12px; border: 1px solid rgba(239, 68, 68, 0.1);">
                        <div style="color: #ef4444; font-size: 12px; font-weight: 800; text-transform: uppercase;">
                            Outstanding Balance</div>
                        <div style="font-size: 20px; font-weight: 800; margin-top: 5px;">EGP 4,100</div>
                    </div>
                </div>

                <h4 style="font-size: 15px; margin-top: 0; color: #475569;">Commission breakdown</h4>
                <div
                    style="background:#f8fafc; padding:20px; border-radius:12px; border: 1px solid #e2e8f0; margin-top:15px;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:12px;">
                        <span style="color: #64748b; font-weight: 600;">Account Type:</span>
                        <strong id="walletRole" style="color: #1e293b;">Host</strong>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-bottom:12px;">
                        <span style="color: #64748b; font-weight: 600;">Platform Fee Rate:</span>
                        <strong id="walletRate" style="color: #ef4444;">5%</strong>
                    </div>
                    <div
                        style="display:flex; justify-content:space-between; border-top:1px dashed #cbd5e1; padding-top:12px;">
                        <span style="color: #64748b; font-weight: 600;">Total Payouts (YTD):</span>
                        <span style="color:#10b981; font-weight: 800;">+ EGP 45,200</span>
                    </div>
                </div>

                <h4 style="font-size: 15px; margin: 30px 0 15px; color: #475569;">Payment Tracking</h4>
                <div class="history-table">
                    <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                        <thead>
                            <tr style="text-align: left; border-bottom: 1px solid #f1f5f9;">
                                <th style="padding: 12px;">Payment Ref</th>
                                <th>Date</th>
                                <th>Paid</th>
                                <th>Remaining</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="payoutTableBody">
                            <tr style="border-bottom: 1px solid #f1f5f9;">
                                <td style="padding: 12px;">DEP-8291</td>
                                <td>Feb 05, 2026</td>
                                <td style="color: #059669; font-weight: 700;">EGP 1,200</td>
                                <td style="color: #64748b;">EGP 3,300</td>
                                <td><span class="status-pill status-confirmed"
                                        style="padding: 4px 8px; font-size: 10px;">Verified</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Add Listing Form -->
        <div id="add-listing" class="panel">
            <h3 style="font-weight: 800; color: #1e293b;">Add New Property</h3>
            <div class="stat-card">
                <div class="grid-2">
                    <div class="form-group">
                        <label
                            style="font-size: 12px; font-weight: 700; color: #64748b; text-transform: uppercase;">Property
                            Title</label>
                        <input id="postTitle" placeholder="e.g. Sunny Studio near AUC"
                            style="border-radius: 10px; padding: 12px;">
                    </div>
                    <div class="form-group">
                        <label
                            style="font-size: 12px; font-weight: 700; color: #64748b; text-transform: uppercase;">Monthly
                            Rent (EGP)</label>
                        <input id="postPrice" type="number" placeholder="3500"
                            style="border-radius: 10px; padding: 12px;">
                    </div>
                </div>
                <div class="grid-2" style="margin-top:20px;">
                    <div class="form-group">
                        <label
                            style="font-size: 12px; font-weight: 700; color: #64748b; text-transform: uppercase;">Location
                            (Area)</label>
                        <select id="postLocation" style="border-radius: 10px; padding: 12px;">
                            <option>Nasr City</option>
                            <option>New Cairo</option>
                            <option>Maadi</option>
                            <option>6th of October</option>
                            <option>Giza</option>
                            <option>Manial (Medical)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label
                            style="font-size: 12px; font-weight: 700; color: #64748b; text-transform: uppercase;">Target
                            Audience</label>
                        <select id="postType" style="border-radius: 10px; padding: 12px;">
                            <option value="Student">Student</option>
                            <option value="Medical">Medical / Niyabat</option>
                            <option value="Employee">Employee / Family</option>
                        </select>
                    </div>
                </div>
                <div class="form-group" style="margin-top:20px;">
                    <label style="font-size: 12px; font-weight: 700; color: #64748b; text-transform: uppercase;">Image
                        URL (Optional)</label>
                    <input id="postImage" placeholder="https://..." style="border-radius: 10px; padding: 12px;">
                </div>

                <div
                    style="margin-top:25px; padding:18px; background:#f0f9ff; border-radius:12px; font-size:13px; border: 1px solid #bae6fd;">
                    <i class="material-icons-round"
                        style="vertical-align:middle; font-size:16px; color: #0369a1;">info</i>
                    <strong style="color: #0369a1;">Financial Note:</strong> You are adding this as a <span
                        id="commRole" style="font-weight: 800;">Host</span>.
                    Platform Commission: <span id="commRate" style="font-weight:900; color:#ef4444;">5%</span> per
                    booking.
                </div>

                <div style="margin-top:25px; display:flex; gap:12px;">
                    <button class="btn btn-primary" onclick="submitListing()" style="padding: 12px 24px;">Publish
                        Listing</button>
                    <button class="btn btn-text" onclick="showSection('my-listings')"
                        style="color: #64748b;">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Community Panel -->
        <div id="community" class="panel">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <div>
                    <h3 style="margin: 0; font-size: 20px; font-weight: 800;">Community Hub</h3>
                    <p style="margin: 5px 0 0; color: #64748b; font-size: 13px;">Connect with people in your building
                        and university.</p>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-outline" style="font-size: 12px; padding: 8px 16px;">Groups</button>
                    <button class="btn btn-primary" style="font-size: 12px; padding: 8px 16px;">+ Create Post</button>
                </div>
            </div>

            <div class="dash-grid" style="grid-template-columns: 1.5fr 1fr; gap: 20px;">
                <!-- Neighbors Feed -->
                <div class="card" style="padding: 24px;">
                    <h4
                        style="margin: 0 0 20px; font-size: 15px; text-transform: uppercase; letter-spacing: 0.5px; color: #475569;">
                        Your Neighbors</h4>
                    <div id="neighborList" style="display: grid; gap: 15px;">
                        <!-- JS Populated -->
                    </div>
                </div>

                <!-- Groups & Events -->
                <div style="display: flex; flex-direction: column; gap: 20px;">
                    <div class="card" style="padding: 24px;">
                        <h4 style="margin: 0 0 15px; font-size: 14px; font-weight: 700;">Active Groups</h4>
                        <div id="groupList" style="display: grid; gap: 12px;">
                            <!-- JS Populated -->
                        </div>
                    </div>

                    <div class="card" style="padding: 24px;">
                        <h4 style="margin: 0 0 15px; font-size: 14px; font-weight: 700;">Upcoming Events</h4>
                        <div id="eventList" style="display: grid; gap: 12px;">
                            <!-- JS Populated -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Management Hub (Host/Broker Only) -->
        <div id="management" class="panel">
            <h3 style="margin: 0 0 24px; font-size: 20px; font-weight: 800;">Management Hub</h3>

            <div class="stat-grid" style="margin-bottom: 24px;">
                <div class="stat-card">
                    <div class="stat-label">Occupancy Rate</div>
                    <div class="stat-val" id="occupancyRate">0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Revenue</div>
                    <div class="stat-val" id="totalRev">EGP 0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Rating Average</div>
                    <div class="stat-val">4.8 ‚≠ê</div>
                </div>
            </div>

            <div class="dash-grid" style="grid-template-columns: 1fr 1fr; gap: 20px;">
                <!-- Issue Tracking -->
                <div class="card" style="padding: 24px;">
                    <h4 style="margin: 0 0 20px; color: #1e293b; font-size: 16px;">Maintenance & Requests</h4>
                    <div id="maintenanceList" style="display: grid; gap: 12px;">
                        <!-- JS Populated -->
                    </div>
                </div>

                <!-- Popularity Analytics -->
                <div class="card" style="padding: 24px;">
                    <h4 style="margin: 0 0 20px; color: #1e293b; font-size: 16px;">Property Performance</h4>
                    <div id="popularityChart" style="display: grid; gap: 15px;">
                        <!-- JS Populated -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Bookings Panel -->
        <div id="bookings" class="panel">
            <h3>Booking Requests</h3>
            <p style="color:var(--text-gray); font-size:13px; margin-bottom:20px;">Manage your incoming or outgoing
                requests here.</p>
            <div id="bookingsList">
                <!-- JS Populated -->
            </div>
        </div>

        <!-- Support Center Panel -->
        <div id="support" class="panel">
            <h3 style="font-weight: 800; color: #1e293b;">Support & Help Center</h3>
            <div class="grid-2">
                <div class="card" style="padding: 25px;">
                    <h4 style="margin: 0 0 15px;">Create a Ticket</h4>
                    <div class="form-group">
                        <label>Issue Type</label>
                        <select id="ticketType"
                            style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #e2e8f0;">
                            <option>Booking Issue</option>
                            <option>Payment Dispute</option>
                            <option>Host Conduct</option>
                            <option>Technical Problem</option>
                            <option>Other</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-top: 15px;">
                        <label>Message</label>
                        <textarea id="ticketMsg" placeholder="Describe your problem in detail..."
                            style="width: 100%; height: 100px; padding: 10px; border-radius: 8px; border: 1px solid #e2e8f0;"></textarea>
                    </div>
                    <button class="btn btn-primary full-width" style="margin-top: 20px;"
                        onclick="alert('Ticket submitted! Support will contact you.')">Submit Ticket</button>
                </div>

                <div class="card" style="padding: 25px;">
                    <h4 style="margin: 0 0 15px;">My Requests</h4>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <div
                            style="background: #f8fafc; padding: 15px; border-radius: 12px; border: 1px solid #e2e8f0;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <strong style="font-size: 13px;">#TK-1082: Payment Delay</strong>
                                <span class="status-pill status-pending" style="font-size: 10px;">Open</span>
                            </div>
                            <p style="margin: 5px 0 0; font-size: 11px; color: #64748b;">Created: Yesterday, 2:15 PM</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 25px; padding: 25px; background: #eef2ff; border-color: #c7d2fe;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h4 style="margin: 0 0 5px; color: #3730a3;">Need Instant Answers?</h4>
                        <p style="margin: 0; color: #3730a3; font-size: 13px; opacity: 0.8;">Our Smart Bot can answer
                            questions about bookings, prices, and verification.</p>
                    </div>
                    <button class="btn btn-primary" onclick="openFAQBot()"
                        style="background: #3730a3; border: none; white-space: nowrap;">Talk to Bot ü§ñ</button>
                </div>
            </div>
        </div>

        <!-- FAQ Bot Modal -->
        <div class="modal-overlay" id="faqBotModal">
            <div class="modal-box"
                style="max-width: 450px; height: 600px; display: flex; flex-direction: column; overflow: hidden; padding: 0;">
                <button class="close-btn" onclick="toggleModal('faqBotModal')"
                    style="top: 15px; right: 15px; z-index: 10;"><i class="material-icons-round">close</i></button>

                <div style="padding: 25px; background: white; border-bottom: 1px solid #f1f5f9;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div
                            style="width: 45px; height: 45px; background: #f0fdf4; color: #16a34a; border-radius: 12px; display: grid; place-items: center;">
                            <i class="material-icons-round" style="font-size: 28px;">smart_toy</i>
                        </div>
                        <div>
                            <h3 style="margin: 0; font-size: 18px;">Saknora Smart Bot</h3>
                            <small style="color: #16a34a; font-weight: 600;">Always Online</small>
                        </div>
                    </div>
                </div>

                <div id="botChatMessages"
                    style="flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; background: #f8fafc;">
                    <div
                        style="align-self: flex-start; background: white; padding: 12px 16px; border-radius: 15px 15px 15px 0; max-width: 85%; font-size: 14px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); color: #1e293b; line-height: 1.5;">
                        Hello! üëã I'm your Saknora assistant. How can I help you today? <br><br>
                        Tip: Ask me about <b>'available rooms'</b>, <b>'how to book'</b>, or <b>'ID verification'</b>.
                    </div>
                </div>

                <div style="padding: 20px; background: white; border-top: 1px solid #f1f5f9; display: flex; gap: 10px;">
                    <input type="text" id="botInput" placeholder="Type your question..."
                        style="flex: 1; padding: 12px 16px; border-radius: 12px; border: 1px solid #e2e8f0; outline: none; font-size: 14px;"
                        onkeypress="if(event.key==='Enter') sendBotMessage()">
                    <button class="btn btn-primary" onclick="sendBotMessage()"
                        style="width: 44px; height: 44px; padding: 0; display: grid; place-items: center;">
                        <i class="material-icons-round">send</i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- DB Script -->
    <script src="db.js"></script>
    <script src="app.js"></script>
    <script>
        // Dashboard Logic using DB.js
        const currentUser = db.getCurrentUser();

        if (!currentUser) {
            window.location.href = 'index.html'; // Protect Route
        }

        // Init UI
        document.getElementById('userName').textContent = currentUser.name;
        document.getElementById('roleBadge').textContent = currentUser.role.toUpperCase();

        const avatarContainer = document.getElementById('userAvatar');
        if (currentUser.profilePic) {
            avatarContainer.style.overflow = 'hidden';
            avatarContainer.innerHTML = `<img src="${currentUser.profilePic}" style="width:100%; height:100%; object-fit:cover;">`;
        } else {
            avatarContainer.textContent = currentUser.name[0];
        }

        // Add specific class to badge
        document.getElementById('roleBadge').className = `role-badge role-${currentUser.role}`;

        // Setup Commission Variables
        const isHost = currentUser.role === 'host';
        const isBroker = currentUser.role === 'broker';
        const commRate = isHost ? '5%' : '10%';
        const roleLabel = isHost ? 'Direct Host' : 'Broker';

        document.getElementById('commRole').textContent = roleLabel;
        document.getElementById('commRate').textContent = commRate;
        document.getElementById('walletRole').textContent = roleLabel;
        document.getElementById('walletRate').textContent = commRate;

        // Custom View Logic
        if (isHost || isBroker) {
            document.getElementById('nav-management').style.display = 'flex';
        }
        if (isBroker) {
            document.getElementById('nav-crm').style.display = 'flex'; // Show CRM for broker
        }

        if (currentUser.role === 'student') {
            document.querySelectorAll('.role-restricted').forEach(el => {
                if (el.id !== 'nav-management' || !isHost) el.style.display = 'none';
            });
            // Specific hide for management for students (already handled by role-restricted but playing safe)
            document.getElementById('nav-management').style.display = 'none';
            document.getElementById('overview').style.display = 'none';
            showSection('bookings');
        } else {
            renderOverview();
        }

        // Helper: Show Section
        function showSection(id) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));

            const targetSection = document.getElementById(id);
            if (targetSection) targetSection.classList.add('active');

            // Set Title
            const titles = {
                'overview': 'Overview',
                'community': 'Community Hub',
                'management': 'Management Hub',
                'my-listings': 'My Properties',
                'bookings': 'Booking Requests',
                'messages': 'Messages',
                'history': 'History',
                'wallet': 'Wallet',
                'support': 'Support Center'
            };
            document.getElementById('page-title').textContent = titles[id] || 'Dashboard';

            // Highlight nav item
            if (id === 'my-listings') document.getElementById('nav-listings').classList.add('active');
            else if (id === 'broker-crm') document.getElementById('nav-crm').classList.add('active');
            else if (id === 'management') document.getElementById('nav-management').classList.add('active');
            else document.querySelector(`[onclick="showSection('${id}')"]`)?.classList.add('active');

            // Render logic
            if (id === 'community') renderCommunity();
            if (id === 'management') renderManagement();
            if (id === 'overview') renderOverview();
        }

        // Render Overview
        function renderOverview() {
            const listings = db.getListings().filter(l => l.ownerId === currentUser.email);
            const bookings = db.getBookings(currentUser.email, currentUser.role);

            document.getElementById('activeListings').textContent = listings.length;
            document.getElementById('totalBookings').textContent = bookings.length;

            renderChecklist();

            // Calculate Wallet Total
            const totalPaid = bookings.reduce((sum, b) => sum + (b.paid || 0), 0);
            document.getElementById('walletBalance').textContent = `EGP ${totalPaid.toLocaleString()}`;
            if (document.getElementById('walletTotal')) {
                document.getElementById('walletTotal').textContent = totalPaid.toLocaleString();
            }

            // Dynamic Time-based Greeting
            const hour = new Date().getHours();
            let greeting = "Welcome back";
            if (hour < 12) greeting = "Good morning";
            else if (hour < 18) greeting = "Good afternoon";
            else greeting = "Good evening";

            document.getElementById('welcomeMsg').textContent = `${greeting}, ${currentUser.name}!`;

            // Render Activity Table
            const tbody = document.getElementById('activityTable');
            tbody.innerHTML = '';

            if (bookings.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; padding: 40px; color: gray;">No recent activity found.</td></tr>';
                return;
            }

            bookings.slice(0, 5).forEach(b => {
                const tr = document.createElement('tr');
                const date = new Date(b.date || Date.now()).toLocaleDateString();
                const paid = b.paid || 0;
                const remaining = (b.price || 0) - paid;

                tr.innerHTML = `
                    <td>
                        <div class="activity-item" style="display:flex; align-items:center; gap:10px;">
                            <div class="activity-icon booking" style="background: ${b.status === 'confirmed' ? '#059669' : b.status === 'rejected' ? '#ef4444' : '#3b82f6'}; border-radius: 8px; width: 32px; height: 32px; display: grid; place-items: center; color: white;">
                                <i class="material-icons-round" style="font-size: 18px;">${b.status === 'confirmed' ? 'check_circle' : b.status === 'rejected' ? 'cancel' : 'event_repeat'}</i>
                            </div>
                            <div>
                                <div style="font-weight: 700; font-size: 13px;">${b.status === 'confirmed' ? 'Booking Approved' : b.status === 'rejected' ? 'Request Declined' : 'New Booking Request'}</div>
                                <small style="color: #64748b; font-size: 11px;">Ref: ${b.listingTitle.substring(0, 15)}...</small>
                            </div>
                        </div>
                    </td>
                    <td style="color: #64748b;">${b.listingTitle}</td>
                    <td>${date}</td>
                    <td><span class="status-pill status-${b.status}" style="font-size: 11px; padding: 4px 10px;">${b.status.toUpperCase()}</span></td>
                    <td style="font-weight: 700; font-size: 13px;">
                        <div style="color: #1e293b;">EGP ${b.price?.toLocaleString()}</div>
                        <div style="font-size: 10px; color: ${remaining === 0 ? '#10b981' : '#ef4444'};">${remaining === 0 ? 'Full Paid' : `Rem: EGP ${remaining.toLocaleString()}`}</div>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Render Listenings
        function renderListings() {
            const listContainer = document.getElementById('dashboardListings');
            const listings = db.getListings().filter(l => l.ownerId === currentUser.email);

            listContainer.innerHTML = '';
            listings.forEach(l => {
                const div = document.createElement('div');
                div.className = 'listing-card';
                div.innerHTML = `
                    <div class="card-img-wrap">
                        <img src="${l.image || 'https://via.placeholder.com/300'}" style="width:100%;height:150px;object-fit:cover">
                        <span class="badge verified">Active</span>
                    </div>
                    <div style="padding:15px">
                        <h4>${l.title}</h4>
                        <div class="price">EGP ${l.price}</div>
                        <div style="font-size:12px;color:gray">${l.location} ‚Ä¢ ${l.type}</div>
                    </div>
                `;
                listContainer.appendChild(div);
            });
        }

        // Submit Listing
        function submitListing() {
            const title = document.getElementById('postTitle').value;
            const price = document.getElementById('postPrice').value;
            const location = document.getElementById('postLocation').value;
            const type = document.getElementById('postType').value;

            if (!title || !price) return alert('Please fill required fields');

            const newListing = {
                title, price, location, type,
                ownerId: currentUser.email,
                image: document.getElementById('postImage').value,
                verified: currentUser.role === 'host' // Direct hosts auto-verified for demo
            };

            db.saveListing(newListing);
            alert('Listing Published Successfully! üè†');
            showSection('my-listings');
            renderListings();
            renderOverview();
        }

        function renderChecklist() {
            const checklistContainer = document.querySelector('.completeness-box');
            if (!checklistContainer) return;

            const items = db.getChecklist(currentUser.email);
            const completedCount = items.filter(i => i.completed).length;
            const progress = Math.round((completedCount / items.length) * 100);

            checklistContainer.innerHTML = `
                <div class="completeness-header">
                    <div>
                        <h4 style="margin: 0; font-size: 16px;">Student Onboarding Checklist</h4>
                        <p style="margin: 5px 0 0; font-size: 13px; opacity: 0.8;">Complete these steps to verify your account.</p>
                    </div>
                    <span style="font-weight: 800; font-size: 18px;">${progress}%</span>
                </div>
                <div class="completeness-bar">
                    <div class="completeness-fill" style="width: ${progress}%"></div>
                </div>
                <div class="checklist-items" style="margin-top: 15px; display: grid; gap: 8px;">
                    ${items.map(item => `
                        <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; font-size: 13px; color: ${item.completed ? '#059669' : '#64748b'};">
                            <i class="material-icons-round" style="font-size: 18px; cursor: pointer;" onclick="toggleChecklist('${item.id}', ${!item.completed})">
                                ${item.completed ? 'check_circle' : 'radio_button_unchecked'}
                            </i>
                            <span style="${item.completed ? 'text-decoration: line-through;' : ''}">${item.label}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function toggleChecklist(itemId, completed) {
            db.updateChecklist(currentUser.email, itemId, completed);
            renderChecklist();
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const chatWindow = document.getElementById('chat-window');
            if (input.value.trim()) {
                const msg = document.createElement('div');
                msg.style = 'align-self: flex-end; background: #059669; color: white; padding: 10px 15px; border-radius: 12px 12px 0 12px; max-width: 70%; font-size: 14px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);';
                msg.textContent = input.value;
                chatWindow.appendChild(msg);
                input.value = '';
                chatWindow.scrollTop = chatWindow.scrollHeight;

                // Simulated Reply
                setTimeout(() => {
                    const reply = document.createElement('div');
                    reply.style = 'align-self: flex-start; background: #f1f5f9; padding: 10px 15px; border-radius: 12px 12px 12px 0; max-width: 70%; font-size: 14px; box-shadow: 0 2px 4px rgba(0,0,0,0.02);';
                    reply.textContent = "Got it! Let me check the schedule and get back to you.";
                    chatWindow.appendChild(reply);
                    chatWindow.scrollTop = chatWindow.scrollHeight;
                }, 1500);
            }
        }
        renderOverview();
        renderListings();

        // Render Community
        function renderCommunity() {
            const bookings = JSON.parse(localStorage.getItem('mysakn_bookings') || '[]');
            const neighborsList = document.getElementById('neighborList');
            const groupList = document.getElementById('groupList');
            const eventList = document.getElementById('eventList');

            // 1. Neighbors (People in the same listings)
            const myBookings = bookings.filter(b => b.studentId === currentUser.email);
            const myListingTitles = myBookings.map(b => b.listingTitle);

            const neighbors = bookings.filter(b => b.studentId !== currentUser.email && myListingTitles.includes(b.listingTitle));

            neighborsList.innerHTML = '';
            if (neighbors.length === 0) {
                neighborsList.innerHTML = '<p style="color:gray; font-size:13px;">No neighbors found yet. Try booking a shared room!</p>';
            } else {
                neighbors.forEach(n => {
                    const div = document.createElement('div');
                    div.style = 'display: flex; align-items: center; gap: 12px; padding: 12px; background: #f8fafc; border-radius: 12px;';
                    div.innerHTML = `
                        <div style="width: 36px; height: 36px; background: #e2e8f0; border-radius: 10px; display: grid; place-items: center; font-weight: 800; color: #475569;">${n.studentId[0].toUpperCase()}</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 700; font-size: 13px;">Student @ ${n.listingTitle}</div>
                            <small style="color: #64748b;">${n.status === 'confirmed' ? 'Validated Resident' : 'Pending'}</small>
                        </div>
                        <button class="btn btn-text" style="color: #3b82f6; font-size: 12px;">Profile</button>
                    `;
                    neighborsList.appendChild(div);
                });
            }

            // 2. Groups
            const groups = db.getGroups();
            groupList.innerHTML = '';
            groups.forEach(g => {
                const div = document.createElement('div');
                div.style = 'display: flex; align-items: center; gap: 10px; font-size: 13px; color: #1e293b;';
                div.innerHTML = `<i class="material-icons-round" style="color: #6366f1;">${g.icon}</i> <span>${g.title} (${g.members} members)</span>`;
                groupList.appendChild(div);
            });

            // 3. Events
            const events = db.getEvents();
            eventList.innerHTML = '';
            events.forEach(e => {
                const div = document.createElement('div');
                div.style = 'background: #fdf2f8; padding: 10px; border-radius: 8px; font-size: 12px; border: 1px solid #fce7f3;';
                div.innerHTML = `<strong>${e.title}</strong><br><small style="color: #be185d;">${e.date} ‚Ä¢ ${e.location}</small>`;
                eventList.appendChild(div);
            });
        }

        // Render Management (Host Only)
        function renderManagement() {
            if (currentUser.role !== 'host' && currentUser.role !== 'broker') return;

            const stats = db.getAnalytics(currentUser.email);
            document.getElementById('occupancyRate').textContent = stats.occupancyRate + '%';
            document.getElementById('totalRev').textContent = 'EGP ' + stats.totalRevenue.toLocaleString();

            // 1. Maintenance Requests
            const requests = db.getMaintenanceRequests(currentUser.email, currentUser.role);
            const reqList = document.getElementById('maintenanceList');
            reqList.innerHTML = '';

            if (requests.length === 0) {
                reqList.innerHTML = '<p style="color:gray; font-size:13px;">No active maintenance requests.</p>';
            } else {
                requests.forEach(r => {
                    const div = document.createElement('div');
                    div.style = 'padding: 15px; background: #f8fafc; border-radius: 12px; border-left: 4px solid ' + (r.status === 'pending' ? '#f59e0b' : '#10b981') + ';';
                    div.innerHTML = `
                        <div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom: 5px;">
                            <strong style="font-size: 14px;">${r.title}</strong>
                            <span class="status-pill status-${r.status}" style="font-size: 10px;">${r.status.toUpperCase()}</span>
                        </div>
                        <p style="margin: 0; font-size: 12px; color: #64748b;">${r.issue}</p>
                        <div style="margin-top: 10px; display: flex; gap: 5px;">
                            <button class="btn btn-outline" style="font-size: 10px; padding: 4px 10px;" onclick="db.updateMaintenanceStatus('${r.id}', 'fixed'); renderManagement();">Mark Fixed</button>
                            <button class="btn btn-text" style="font-size: 10px; padding: 4px 10px;">Contact</button>
                        </div>
                    `;
                    reqList.appendChild(div);
                });
            }

            // 2. Property Popularity (Simulated Charts)
            const popChart = document.getElementById('popularityChart');
            popChart.innerHTML = '';
            stats.popularityScale.forEach(p => {
                const perc = (p.views / 500 * 100);
                const div = document.createElement('div');
                div.innerHTML = `
                    <div style="display:flex; justify-content:space-between; font-size:12px; margin-bottom: 5px;">
                        <span>${p.title}</span>
                        <strong>${p.views} Views</strong>
                    </div>
                    <div style="height: 6px; background: #f1f5f9; border-radius: 3px; overflow:hidden;">
                        <div style="height: 100%; width: ${perc}%; background: #3b82f6;"></div>
                    </div>
                `;
                popChart.appendChild(div);
            });
        }

        function sendBotMessage() {
            const input = document.getElementById('botInput');
            const chatWindow = document.getElementById('botChatMessages');
            const text = input.value.trim().toLowerCase();

            if (!text) return;

            // User Message
            const uMsg = document.createElement('div');
            uMsg.style = 'align-self: flex-end; background: var(--primary); color: white; padding: 12px 16px; border-radius: 15px 15px 0 15px; max-width: 80%; font-size: 14px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);';
            uMsg.textContent = input.value;
            chatWindow.appendChild(uMsg);
            input.value = '';
            chatWindow.scrollTop = chatWindow.scrollHeight;

            // Bot Thinking
            setTimeout(() => {
                let response = "I'm not sure about that. Let me connect you to a human agent, or try asking about 'available rooms', 'verification', or 'booking process'.";

                if (text.includes('available') || text.includes('rooms') || text.includes('ÿ∫ÿ±ŸÅ')) {
                    response = "You can check all available rooms on the 'Exploration' page. Use the filters to find exactly what you need!";
                } else if (text.includes('verify') || text.includes('id') || text.includes('ÿ™ÿ≠ŸÇŸÇ')) {
                    response = "To verify your account, upload your ID and University ID in the Settings -> Documents section.";
                    db.updateChecklist(currentUser.email, 'docs', true);
                    renderChecklist();
                } else if (text.includes('price') || text.includes('egp') || text.includes('ÿ≥ÿπÿ±')) {
                    response = "Room prices vary by location, but the average student room in Dokki is around 2000-3000 EGP per month.";
                }

                const bMsg = document.createElement('div');
                bMsg.style = 'align-self: flex-start; background: white; padding: 12px 16px; border-radius: 15px 15px 15px 0; max-width: 80%; font-size: 14px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);';
                bMsg.textContent = response;
                chatWindow.appendChild(bMsg);
                chatWindow.scrollTop = chatWindow.scrollHeight;
            }, 1000);
        }
    </script>
</body>

</html>